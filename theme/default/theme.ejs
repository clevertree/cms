<%
let hostname = req ? req.headers.host.split(':')[0] : null;

const slashCount = req.path.split('/').length-1;
const baseHRef = slashCount > 1 ? "../".repeat(slashCount-1) : null;
%><!DOCTYPE html>
<html>
    <head>
        <base href="<%=baseHRef;%>">
        <title><%=hostname || "Website"%></title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="keywords" CONTENT="<%=hostname || "Website"%>">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="theme/default/assets/default.theme.css" rel="stylesheet" />
        <script src="theme/default/assets/default.theme.client.js"></script>
    </head>
    <body class='theme-default'>
        <header>
            <div class="logo-container">
                <div class="logo"></div>
                <a href="" class="logo-text">
                    <%=hostname || "Website"%>
                </a>
            </div>
            <nav>
                <%- include('./partial/nav.ejs') %>
            </nav>
        </header>

        <article>
            <%_ if(typeof req !== "undefined" && req.session) {
                    if(req.session.messages && req.session.messages.length > 0) {
                        const sessionMessage = req.session.messages.pop();
            _%>
            <section class="message">
                <%-sessionMessage.message%>
            </section>
            <%_     } _%>

            <%_     if(typeof article !== "undefined") { _%>
            <section class="page-edit" style="text-align: center; font-size: smaller;">
                <a href=":article/<%=article.id%>/edit">Edit this page</a>
            </section>
            <%_     } _%>
            <%_ } _%>

            <%-content%>
        </article>

        <footer>
            <ul class="flex-list" style="align-items: normal;">
                <li>
                    <h2>Created With</h2>
                    <a class="created-by" target='_blank' href='https://github.com/clevertree/cms'>CleverTree CMS</a>
                </li>
                <li>
                    <h2>Get Involved!</h2>
                    <p>
                    </p>
                </li>
                <li>
                    <h2>Contact Us</h2>
                    <p>
                        Email: <a href="mailto:admin@<%=hostname%>">admin@<%=hostname%></a>
                        <br/>
                        Copyright Clevertree LLC
                    </p>
                </li>
            </ul>
        </footer>
    </body>
</html>